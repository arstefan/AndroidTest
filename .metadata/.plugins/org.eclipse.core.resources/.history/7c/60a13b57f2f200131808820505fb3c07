package com.zinga.stockportfolio;

import java.util.ArrayList;

import android.app.ListActivity;
import android.content.ComponentName;
import android.content.Context;
import android.content.Intent;
import android.content.ServiceConnection;
import android.os.Bundle;
import android.os.IBinder;
import android.os.RemoteException;
import android.util.Log;
import android.view.Menu;

import com.zinga.stockportfolio.service.IStockService;

public class ViewStocks extends ListActivity {
	
	private ArrayList<Stock> stocks;
	private IStockService stockService;
	
	
	public void onStart(Bundle savedInstanceState){
		super.onStart();
		bindService(new Intent(IStockService.class.getName()), connection, Context.BIND_AUTO_CREATE);
	}
	
	
	/*
	 * delegat informuj¹cy o cyklu ¿ycia po³¹czenia ze zdaln¹ us³ug¹
	 * -- pobieramy tu interfejs zdalnej us³ugi (reprezentowanej za pomoc¹ interfejsu IBinder)
	 * -- uzyskania implementacji lokalnego interfejsu
	 * 
	 */
	private ServiceConnection connection = new ServiceConnection() {
		
		@Override
		public void onServiceDisconnected(ComponentName name) {
			// TODO Auto-generated method stub
			
		}
		
		@Override
		public void onServiceConnected(ComponentName name, IBinder service) {
			// TODO Auto-generated method stub
			stockService = IStockService.Stub.asInterface(service);
			try {
				stocks = (ArrayList<Stock>) stockService.getPortfolio();
			} catch (RemoteException e) {
				// TODO Auto-generated catch block
				Log.e(tag, msg);
			}
			
		}
	};
	
	
	
	
    @Override
    protected void onCreate(Bundle savedInstanceState) {
        super.onCreate(savedInstanceState);
        setContentView(R.layout.main);
    }

    @Override
    public boolean onCreateOptionsMenu(Menu menu) {
        // Inflate the menu; this adds items to the action bar if it is present.
        getMenuInflater().inflate(R.menu.view_stocks, menu);
        return true;
    }  
}
